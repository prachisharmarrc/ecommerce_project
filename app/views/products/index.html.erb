<!-- app/views/products/index.html.erb -->
<h1>Products</h1>

<%= form_with url: products_path, method: :get, local: true do %>
  <div>
    <%= label_tag :keyword, 'Search by keyword:' %>
    <%= text_field_tag :keyword, params[:keyword] %>
  </div>
  <div>
    <%= label_tag :category_id, 'Filter by category:' %>
    <%= select_tag :category_id, options_from_collection_for_select(Category.all, :id, :category_name, params[:category_id]), include_blank: 'All Categories' %>
  </div>
  <div>
    <%= label_tag :filter, 'Filter by:' %>
    <%= select_tag :filter, options_for_select([['On Sale', 'on_sale'], ['New', 'new'], ['Recently Updated', 'recently_updated']], params[:filter]), include_blank: 'None' %>
  </div>
  <div>
    <%= submit_tag 'Search' %>
  </div>
<% end %>

<ul>
  <% @products.each do |product| %>
    <li>
      <% if product.image.attached? %>
        <%= image_tag(product.image, alt: product.product_name, style: "width: 100px; height: auto;") %>
      <% end %>
      <p><%= link_to product.product_name, product_path(product) %></p>
      <p><%= product.description %></p>
      <p><%= number_to_currency(product.price) %></p>
    </li>
  <% end %>
</ul>

<%= paginate @products %>
